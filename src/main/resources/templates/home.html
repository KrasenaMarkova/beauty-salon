<!DOCTYPE html>
<html lang="bg" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="'–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª | ' + ${user.firstName} + ' ' + ${user.lastName}">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</title>
  <link rel="stylesheet" type="text/css" href="/css/index.css">
</head>
<body>

<div class="top-header">
  <div class="contact">üìû 0888 123 456</div>
  <div class="address">üìç –≥—Ä. –†—É—Å–µ, –±—É–ª. –ö—Ä–∞—Å–æ—Ç–∞ 19</div>
</div>

<!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
<header class="info">
  <nav>
    <ul>
      <li><a th:href="@{/home}">–ù–∞—á–∞–ª–æ</a></li>
      <li><a th:href="@{/services}">–£—Å–ª—É–≥–∏</a></li>
      <li><a th:href="@{/team}">–ï–∫–∏–ø</a></li>
      <li><a th:href="@{/about}">–ó–∞ –Ω–∞—Å</a></li>
      <li><a th:href="@{/logout}">–ò–∑—Ö–æ–¥</a></li>
    </ul>
  </nav>
</header>

<section class="hero">
  <div class="hero-text">
    <h1>–î–æ–±—Ä–µ –¥–æ—à–ª–∏, <span th:text="${user.firstName}">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª</span>!</h1>
    <p>–†–∞–¥–≤–∞–º–µ —Å–µ, —á–µ –æ—Ç–Ω–æ–≤–æ —Å—Ç–µ —Å –Ω–∞—Å üíá‚Äç‚ôÄÔ∏è</p>
    <a class="btn" th:href="@{/booking}">–ó–∞–ø–∞–∑–∏ –Ω–æ–≤ —á–∞—Å</a>
  </div>
</section>

<main class="container" style="display: flex; gap: 20px; margin-top: 20px;">

  <section class="user-info" style="flex: 1; max-width: 33%;">
    <h2>–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</h2>
    <div class="user-card"
         style="background-color: #ffe0f0; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
      <p><strong>–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ:</strong> <span th:text="${user.username}"></span></p>
      <p><strong>–ò–º–µ:</strong> <span th:text="${user.firstName} + ' ' + ${user.lastName}"></span>
      </p>
      <p><strong>–ò–º–µ–π–ª:</strong> <span th:text="${user.email}"></span></p>
      <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span th:text="${user.phone}"></span></p>
      <a class="edit-btn" th:href="@{'/users/' + ${user.id} + '/profile'}"
         style="display: inline-block; margin-top: 10px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π –ø—Ä–æ—Ñ–∏–ª</a>

      <!-- –ù–æ–≤ –±—É—Ç–æ–Ω –∑–∞ –º–∏–Ω–∞–ª–∏ —á–∞—Å–æ–≤–µ -->
      <a class="edit-btn" th:href="@{/appointments/history}"
         style="display: inline-block; margin-top: 10px; background-color: #d63384;">
        ‚è∞ –ú–æ–∏—Ç–µ –º–∏–Ω–∞–ª–∏ —á–∞—Å–æ–≤–µ
      </a>
    </div>
  </section>


  <!-- –¢–∞–±–ª–∏—Ü–∞ —Å —á–∞—Å–æ–≤–µ—Ç–µ -->
  <section class="appointments" style="flex: 2; max-width: 66%;">
    <h2 style="text-align: center; color: #4a004e; margin-bottom: 20px;">–ú–æ–∏—Ç–µ –∑–∞–ø–∏—Å–∞–Ω–∏ —á–∞—Å–æ–≤–µ</h2>

    <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –ø—Ä–∞–∑–µ–Ω —Å–ø–∏—Å—ä–∫ –∞–∫—Ç–∏–≤–Ω–∏ —á–∞—Å–æ–≤–µ -->
    <div th:if="${#lists.isEmpty(activeAppointments)}"
         style="text-align: center; margin-top: 20px;">
      <p>–í—Å–µ –æ—â–µ –Ω—è–º–∞—Ç–µ –∑–∞–ø–∏—Å–∞–Ω–∏ —á–∞—Å–æ–≤–µ.</p>
      <a class="btn" th:href="@{/appointments/history}"
         style="margin-top: 10px; display: inline-block;">–ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –º–∏–Ω–∞–ª–∏ –∏–ª–∏ –æ—Ç–º–µ–Ω–µ–Ω–∏ —á–∞—Å–æ–≤–µ</a>
    </div>

    <div th:if="${!#lists.isEmpty(allAppointment)}"
         style="display: flex; flex-direction: column; gap: 15px; margin-top: 20px;">

      <div
          style="display: flex; background-color: #f7c6d9; color: #4a004e; font-weight: bold; padding: 12px 20px; border-radius: 10px; text-align: center;">
        <div style="flex: 2;">–î–∞—Ç–∞ –∏ —á–∞—Å</div>
        <div style="flex: 2;">–£—Å–ª—É–≥–∞</div>
        <div style="flex: 1;">–¶–µ–Ω–∞</div>
        <div style="flex: 1;">–í—Ä–µ–º–µ—Ç—Ä–∞–µ–Ω–µ</div>
        <div style="flex: 1;">–°—Ç–∞—Ç—É—Å</div>
        <div style="flex: 1;">–†–µ–¥–∞–∫—Ü–∏—è</div>
        <div style="flex: 1;">–û—Ç–º—è–Ω–∞ –Ω–∞ —á–∞—Å</div>
      </div>

      <div th:each="appointment : ${allAppointment}"
           th:if="${appointment.status.name() == 'SCHEDULED'}"
           style="display: flex; align-items: center; padding: 15px 20px; background-color: #ffe0f0; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); gap: 10px;">

        <div style="flex: 2;"
             th:text="${#temporals.format(appointment.appointmentDate, 'dd.MM.yyyy HH:mm')}"></div>
        <div style="flex: 2;"
             th:text="${appointment.treatment != null ? appointment.treatment.beautyTreatmentName : '‚Äì'}"></div>
        <div style="flex: 1;" th:text="${appointment.price + ' –ª–≤.'}"></div>
        <div style="flex: 1;" th:text="${appointment.durationMinutes + ' –º–∏–Ω.'}"></div>
        <div style="flex: 1;" th:text="${appointment.status}"></div>

        <div style="flex: 1; text-align: right;">
          <a class="edit-btn"
             th:href="@{'/appointments/' + ${appointment.id} + '/edit'}">
            –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
          </a>
        </div>

        <div style="flex: 1; text-align: right;">
          <form th:action="@{'/appointments/' + ${appointment.id} + '/cancel'}" th:method="POST">
            <button class="edit-btn" th:disabled="${appointment.status == 'CANCELLED'}">
              –û—Ç–∫–∞–∂–∏
            </button>
          </form>
        </div>
      </div>
    </div>

  </section>

</main>

<th:block th:insert="~{fragments/footer :: my-footer}"></th:block>

</body>
</html>